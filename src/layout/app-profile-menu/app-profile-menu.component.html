<div class="flex flex-col">
    <div class="flex flex-col items-center">
        <p-avatar [label]="user.initials" [style]="{ 'background-color': '#dee9fc' }" size="xlarge" shape="circle"></p-avatar>
        <div class="font-bold mt-2">{{ user.name }}</div>
        <div class="text-sm text-color-secondary">{{ user.email }}</div>
    </div>
    <p-divider></p-divider>
    <ul class="list-none p-0 m-0">
        <li>
            <div class="p-menuitem-link flex items-center mx-4 my-2">
                <span class="p-menuitem-icon pi pi-moon mr-2"></span>
                <span class="p-menuitem-text">{{ 'preferences.profile.autoDarkMode' | translate }}</span>
                <p-toggleswitch [(ngModel)]="autoDarkMode" (onChange)="onAutoDarkModeChange($event)" class="ml-auto"></p-toggleswitch>
            </div>
        </li>
        <li>
            <button pButton pRipple type="button" class="p-button-text w-full text-left flex items-center p-menuitem-link" (click)="resetPreferences()">
                <span class="p-menuitem-icon pi pi-cog mr-2"></span>
                <span class="p-menuitem-text">{{ 'preferences.profile.reset.title' | translate }}</span>
            </button>
        </li>
    </ul>

    <!-- Developer Section -->
    <div *ngIf="isDeveloperMode">
        <p-divider></p-divider>
        <div class="mx-4 my-2">
            <div class="flex items-center mb-2">
                <span class="pi pi-code text-orange-500 mr-2"></span>
                <span class="font-semibold text-sm">Developer Tools</span>
                <p-badge value="DEV" severity="warn" size="small" class="ml-2"></p-badge>
            </div>

            <!-- Current Environment Display -->
            <div class="mb-3 p-2 bg-gray-50 dark:bg-gray-800 rounded text-xs">
                <div class="font-medium text-gray-700 dark:text-gray-300">Current: {{ currentStage?.label }}</div>
                <div class="text-gray-500 dark:text-gray-400">{{ currentStage?.description }}</div>
            </div>

            <!-- Environment Switcher -->
            <div class="mb-2">
                <label class="block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1">Switch Environment:</label>
                <p-select [(ngModel)]="selectedStage" [options]="availableStages" optionLabel="label" placeholder="Select Environment" class="w-full" [showClear]="false">
                    <ng-template pTemplate="selectedItem">
                        <div *ngIf="selectedStage" class="flex items-center">
                            <span class="text-sm">{{ selectedStage.label }}</span>
                        </div>
                    </ng-template>
                    <ng-template pTemplate="item" let-stage>
                        <div class="flex flex-col">
                            <span class="font-medium">{{ stage.label }}</span>
                            <span class="text-xs text-gray-500">{{ stage.description }}</span>
                        </div>
                    </ng-template>
                </p-select>
            </div>

            <!-- Environment Action Buttons -->
            <div class="mt-4">
                <!-- Switch Button -->
                <p-button
                    label="Switch & Reload"
                    icon="pi pi-refresh"
                    size="small"
                    class="w-full block mb-3"
                    [disabled]="!selectedStage || selectedStage === currentStage"
                    (click)="switchEnvironment()"
                    pTooltip="Switch to selected environment and reload application"
                    tooltipPosition="bottom"
                    tooltipZIndex="99999"
                ></p-button>

                <!-- Environment Info Button -->
                <p-button
                    label="Environment Info"
                    icon="pi pi-info-circle"
                    size="small"
                    severity="secondary"
                    class="w-full block mb-3"
                    (click)="getEnvironmentInfo()"
                    pTooltip="Log detailed environment information to console"
                    tooltipPosition="bottom"
                    tooltipZIndex="99999"
                >
                </p-button>

                <!-- Reset to Default Button -->
                <p-button
                    label="Reset to Default"
                    icon="pi pi-undo"
                    size="small"
                    severity="secondary"
                    class="w-full block"
                    (click)="resetToDefault()"
                    pTooltip="Clear environment override and reload with default configuration"
                    tooltipPosition="bottom"
                    tooltipZIndex="99999"
                >
                </p-button>
                <!-- Switch Button -->
                <p-button label="Open Developer Menu" icon="pi pi-wrench" size="small" class="w-full block mt-3" (click)="openDeveloperMenu()" pTooltip="Open the developer menu" tooltipPosition="bottom" tooltipZIndex="99999"></p-button>
            </div>
        </div>
    </div>
</div>
